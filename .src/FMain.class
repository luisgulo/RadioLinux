' Gambas class file

Public arrayRadios As String[] = [""]
Public arrayMSG As String[] = [""]
Public IdProceso As String = ""
Public idEmisora As Integer = 0
Public Apagada As Boolean = True
Public Ubicacion As Integer = 1
Public ArrayTipoMusica As String[] = [""]
Public BloqueEmisoras As Integer = 0


Public Sub Form_Open()
   label_version.Text = "RadioLinux " & Application.Version
    Ubicacion = 1
    Situate()
    System.Shell = "/bin/bash"
    RellenaTipos() ' Todos los tipos de Musica (5 emisoras x tipo)
    RellenaRadios
    BloqueEmisoras = 0
    idEmisora = 0
    Emisora() 'Iniciar la emisora y escuchar
End

Public Sub botonMenu_MouseDown()
  BloqueEmisoras = BloqueEmisoras + 1
  If BloqueEmisoras > 17
    BloqueEmisoras = 0 
  Endif
  CambiaEmisoras()
  Emisora()
End

Public Sub botonSiguiente_MouseDown()
  idEmisora = idEmisora + 1
  If idEmisora >= arrayRadios.Length - 1
    idEmisora = 0
  Endif
  Emisora()
End

Public Sub botonAnterior_MouseDown()
  idEmisora = idEmisora - 1
  If idEmisora < 0
    idEmisora = arrayRadios.Length - 2
  Endif 
  Emisora()
End

Public Sub botonParar_MouseDown()
  If Apagada = True
    ' Si esta apagada y vuelve a pulsar se enciende
    Emisora()
  Else
    'Apagada=false. Tu lo que quieres es apagarla...
    'Matamos mplayers previos si los hay
    Shell "killall -9 mplayer 2>/dev/null" Wait
    apagada = True
  Endif
End

Public Function Situate()
 ' Cambiamos de sitio la radio por si molesta en la pantalla
  Select Case Ubicacion
      Case 1
        Me.x = 5
        Me.y = 5
      Case 2
        Me.X = Screen.Width - Me.Width - 5
        Me.y = 5
      Case 3
        Me.X = 5
        Me.y = Screen.Height - Me.Height - 5
      Case 4
        Me.X = Screen.Width - Me.Width - 5
        Me.y = Screen.Height - Me.Height - 5
      Case Else
        Me.X = 5
        Me.y = 5  
  End Select  
End


Public Function RellenaRadios()
  ' CREAR el array por defecto de musica Vintage (Seleccion SoloConLinux para RadioLinux)
    arrayRadios.Add("http://listen.radionomy.com:80/TheBigBandEra", 0)
    arrayMSG.Add("Big Band Era", 0)
    arrayRadios.Add("http://94.23.23.97:7244/", 1)
    arrayMSG.Add("Mega1050 40s", 1)
    arrayRadios.Add("http://uk1-pn.webcast-server.net:8384/", 2)
    arrayMSG.Add("Shawn Nagy's", 2)
    arrayRadios.Add("http://listen.shoutcast.com/kwporadioonline", 3)
    arrayMSG.Add("KWPO Radio", 3)
    arrayRadios.Add("http://s2.radio.co/s60ca9ca66/listen", 4)
    arrayMSG.Add("Kandy Radio", 4)
End

Public Function RellenaTipos()
  ArrayTipoMusica.Add("* RadioLinux *", 0)
  ArrayTipoMusica.Add("* Años 50 *", 1)
  ArrayTipoMusica.Add("* Años 60 *", 2)  
  ArrayTipoMusica.Add("* Años 70 *", 3)
  ArrayTipoMusica.Add("* Años 80 *", 4) 
  ArrayTipoMusica.Add("* Años 90 *", 5) 
  ArrayTipoMusica.Add("* Ambiente *", 6) 
  ArrayTipoMusica.Add("* Banda Sonora *", 7) 
  ArrayTipoMusica.Add("* Blues *", 8) 
  ArrayTipoMusica.Add("* Japonesa *", 9)
  ArrayTipoMusica.Add("* New Age *", 10)
  ArrayTipoMusica.Add("* Psicodelica *", 11)
  ArrayTipoMusica.Add("* Romantica *", 12)
  ArrayTipoMusica.Add("* Top 40 *", 13)
  ArrayTipoMusica.Add("* Mix 1 *", 14)
  ArrayTipoMusica.Add("* Mix 2 *", 15)
  ArrayTipoMusica.Add("* Mix 3 *", 16)
  ArrayTipoMusica.Add("* Mix 4 *", 17) 
End


Public Function Emisora()
  If arrayRadios.Count = 0 Or IsNull(arrayRadios)
    'Algo raro sucedio... no hay radios
    Message.Title = "Error en Emisoras"
    Message.Error("No se ha podido cargar ninguna emisora.")
    Quit
  Endif
  ' Matamos mplayers previos si los hay
  labelEMISORA.text = "... " & idEmisora & " ..."
  labelTipoEmisora.Text = ArrayTipoMusica[BloqueEmisoras]
  Shell "killall -9 mplayer 2>/dev/null" Wait
  '' Mplayer en background en consola:
  ' mplayer http://listen.radionomy.com:80/TheBigBandEra </dev/null >/dev/null 2>&1 & 
  Dim URLEmisora As String
  URLEmisora = arrayRadios[idEmisora]
  labelEMISORA.Text = arrayMSG[idEmisora]
  '' MPlayer en Background en Gambas:
  Shell "/usr/bin/mplayer " & URLEmisora & " 1>/dev/null 2>/dev/null &" 
  Apagada = False
End


Public Sub botonMas_MouseDown()
  ' Matamos mplayers previos si los hay
  Shell "killall -9 mplayer 2>/dev/null" Wait
  Quit
End

Public Sub botonMenos_MouseDown()
  Ubicacion = Ubicacion + 1
  If Ubicacion >= 5
    Ubicacion = 1
  Endif
  Situate()
End

Public Function CambiaEmisoras()
   'Cambiamos de Tipo de Musica.
   ' Bloques de emisoras de 5 en 5 máximo
    Select Case BloqueEmisoras
      Case 0
        ' Radio Linux - Años 30 y 40
        arrayMSG[0] = "Big Band Era"
        arrayRadios[0] = "http://listen.radionomy.com:80/TheBigBandEra"
        arrayMSG[1] = "Mega1050 40s"
        arrayRadios[1] = "http://94.23.23.97:7244/"
        arrayMSG[2] = "Shawn Nagy's"
        arrayRadios[2] = "http://uk1-pn.webcast-server.net:8384/"
        arrayMSG[3] = "KWPO Radio"
        arrayRadios[3] = "http://listen.shoutcast.com/kwporadioonline"
        arrayMSG[4] = "Kandy Radio"
        arrayRadios[4] = "http://s2.radio.co/s60ca9ca66/listen"
      Case 1
        ' Años 50
        arrayMSG[0] = "Majestic"
        arrayRadios[0] = "http://91.121.205.70:4252/"
        arrayMSG[1] = "Block Radio"
        arrayRadios[1] = "http://uk6.internet-radio.com:8465/stream"
        arrayMSG[2] = "ABC 50s"
        arrayRadios[2] = "http://144.217.253.136:8582/stream"
        arrayMSG[3] = "MCN Terry Lees"
        arrayRadios[3] = "http://199.115.117.77:8805/"
        arrayMSG[4] = "RFP Radio"
        arrayRadios[4] = "http://209.95.50.189:8142/stream"        
      Case 2
        ' Años 60
        arrayMSG[0] = "KSQM FM"
        arrayRadios[0] = "http://38.96.148.18:8494/"
        arrayMSG[1] = "Count Down"
        arrayRadios[1] = "http://104.251.118.50:8705/stream"
        arrayMSG[2] = "Dusty Bag"
        arrayRadios[2] = "http://162.216.17.221:8128/stream"
        arrayMSG[3] = "Sergeant Will"
        arrayRadios[3] = "http://67.212.189.122:8044/stream"
        arrayMSG[4] = "DooWopDaves"
        arrayRadios[4] = "http://91.121.78.191:8000/stream"        
      Case 3
        'Años 70
        arrayMSG[0] = "Paradise 70s"
        arrayRadios[0] = "http://107.170.166.187:8000/"
        arrayMSG[1] = "Shadow Deep"
        arrayRadios[1] = "http://162.244.80.131:8020/stream"
        arrayMSG[2] = "Gaverom Roep"
        arrayRadios[2] = "http://91.121.155.140:18192/"
        arrayMSG[3] = "WSSE G&M"
        arrayRadios[3] = "http://144.217.76.188:8067/stream"
        arrayMSG[4] = "Oldies 70s"
        arrayRadios[4] = "http://78.129.227.10:8260/"          
      Case 4
        ' Años 80
        arrayMSG[0] = "Mac Jingle"
        arrayRadios[0] = "http://83.169.10.48:7210/"
        arrayMSG[1] = "NorthSea UK"
        arrayRadios[1] = "http://109.169.54.86:7002/stream"
        arrayMSG[2] = "Disco Classic"
        arrayRadios[2] = "http://54.36.89.71:8742/stream"
        arrayMSG[3] = "Dave FM"
        arrayRadios[3] = "http://91.121.1.157:4618/"
        arrayMSG[4] = "Gold Radio"
        arrayRadios[4] = "http://199.233.234.34:25418/stream"          
      Case 5
        ' Años 90
        arrayMSG[0] = "OE3 Radio"
        arrayRadios[0] = "http://185.85.29.166:8000/"
        arrayMSG[1] = "ORF Radio"
        arrayRadios[1] = "http://mp3stream2.apasf.apa.at:8000/"
        arrayMSG[2] = "Oldies 90s"
        arrayRadios[2] = "http://51.15.152.81:8085/stream"
        arrayMSG[3] = "Mela Radio"
        arrayRadios[3] = "http://5.39.82.157:8016/stream"
        arrayMSG[4] = "247 Radio"
        arrayRadios[4] = "http://uk6.internet-radio.com:8039/stream"         
      Case 6
        ' Ambiente
        arrayMSG[0] = "Smooth Lounge"
        arrayRadios[0] = "http://144.217.158.181:80/live"
        arrayMSG[1] = "Emotions Play"
        arrayRadios[1] = "http://5.39.82.157:8054/stream"
        arrayMSG[2] = "Chill Trax"
        arrayRadios[2] = "http://station.chilltrax.com:80/"
        arrayMSG[3] = "Psyndora"
        arrayRadios[3] = "http://95.217.39.141:9125/stream"
        arrayMSG[4] = "Chill Lounge"
        arrayRadios[4] = "http://us5.internet-radio.com:8283/stream"                 
      Case 7
        ' Banda Sonora
        arrayMSG[0] = "CINEMIX Radio"
        arrayRadios[0] = "http://158.69.38.195:20082/stream"
        arrayMSG[1] = "Matts Movie"
        arrayRadios[1] = "http://37.59.38.180:11732/"
        arrayMSG[2] = "First Love"
        arrayRadios[2] = "http://107.191.38.218:9948/"
        arrayMSG[3] = "Domeldo Radio"
        arrayRadios[3] = "http://185.105.4.53:3006/stream"
        arrayMSG[4] = "Sorcerer"
        arrayRadios[4] = "http://149.56.157.81:5224/stream2"                 
      Case 8
       ' Blues 
        arrayMSG[0] = "Big Blue"
        arrayRadios[0] = "http://209.236.126.18:8002/"
        arrayMSG[1] = "Joint Blues"
        arrayRadios[1] = "http://64.71.79.181:9992/stream"
        arrayMSG[2] = "Top Blues"
        arrayRadios[2] = "http://us3.internet-radio.com:8342/stream"
        arrayMSG[3] = "Blues Radio"
        arrayRadios[3] = "http://95.217.68.35:8352/stream"
        arrayMSG[4] = "Blues Master"
        arrayRadios[4] = "http://104.250.143.18:8108/stream"        
      Case 9
        ' Japonesa
        arrayMSG[0] = "Japan Next"
        arrayRadios[0] = "http://198.50.158.92:8803/stream"
        arrayMSG[1] = "J1 Gold"
        arrayRadios[1] = "http://66.70.187.44:9069/j1"
        arrayMSG[2] = "Armitages"
        arrayRadios[2] = "http://62.75.253.56:8012/"
        arrayMSG[3] = "SoniXCat"
        arrayRadios[3] = "http://bb37.sonixcast.com:2080/8366"
        arrayMSG[4] = "J Idols"
        arrayRadios[4] = "http://184.75.223.178:8011/stream"          
      Case 10
        ' New Age
        arrayMSG[0] = "Vibration Zen"
        arrayRadios[0] = "http://91.121.38.100:8220/vibrationzenrelax-128k.mp3"
        arrayMSG[1] = "Gem Radio"
        arrayRadios[1] = "http://62.210.10.4:8928/stream"
        arrayMSG[2] = "Eightie Wave"
        arrayRadios[2] = "http://83.170.76.233:8018/"
        arrayMSG[3] = "Yimago4"
        arrayRadios[3] = "http://199.195.194.94:8109/stream"
        arrayMSG[4] = "Addicted Wave"
        arrayRadios[4] = "http://208.77.21.33:15330/"          
      Case 11
        ' Psicodelica
        arrayMSG[0] = "Psytrance"
        arrayRadios[0] = "http://212.96.160.160:8022/"
        arrayMSG[1] = "Psybient"
        arrayRadios[1] = "http://198.24.145.146:9318/stream"
        arrayMSG[2] = "Delicized"
        arrayRadios[2] = "http://199.58.160.146:8006/"
        arrayMSG[3] = "East 7th"
        arrayRadios[3] = "http://94.249.254.14:7592/stream"
        arrayMSG[4] = "Radio TimeOut"
        arrayRadios[4] = "http://145.239.26.146:7352/"          
      Case 12
        ' Romantica
        arrayMSG[0] = "MB Love"
        arrayRadios[0] = "http://170.75.146.162:9170/"
        arrayMSG[1] = "Romatic Love"
        arrayRadios[1] = "http://62.210.24.124:8561/stream"
        arrayMSG[2] = "Music Day"
        arrayRadios[2] = "http://145.239.26.146:7286/"
        arrayMSG[3] = "Radio Vis"
        arrayRadios[3] = "http://89.39.189.44:8000/"
        arrayMSG[4] = "Best Romantic"
        arrayRadios[4] = "http://89.39.189.2:8877/stream"          
      Case 13
        ' Top 40
        arrayMSG[0] = "Sunshinet Top"
        arrayRadios[0] = "http://195.56.193.129:8100/sunshine"
        arrayMSG[1] = "Farenheit"
        arrayRadios[1] = "http://200.58.106.247:8624/stream"
        arrayMSG[2] = "BeMyRadio"
        arrayRadios[2] = "http://46.105.118.14:12500/"
        arrayMSG[3] = "BIZ Radio"
        arrayRadios[3] = "http://173.192.207.51:7104/stream"
        arrayMSG[4] = "Dance Time"
        arrayRadios[4] = "http://uk6.internet-radio.com:8332/stream"          
      Case 14
        ' MIX 01
        arrayMSG[0] = "PianoStation"
        arrayRadios[0] = "http://listen.radionomy.com/Pianostation"
        arrayMSG[1] = "Instr. Mate"
        arrayRadios[1] = "http://listen.radionomy.com:80/InstrumentalIMATE"
        arrayMSG[2] = "Exxitos FM"
        arrayRadios[2] = "http://listen.radionomy.com:80/exxitosfm"
        arrayMSG[3] = "HIT Box"
        arrayRadios[3] = "http://192.227.85.169:4271/stream"
        arrayMSG[4] = "Ozarks Mix"
        arrayRadios[4] = "http://64.150.176.42:8186/strea"          
      Case 15
        ' MIX 02
        arrayMSG[0] = "Retro Wave"
        arrayRadios[0] = "http://139.162.14.151:9090/160mp3"
        arrayMSG[1] = "Circuit Pride"
        arrayRadios[1] = "http://185.33.21.112:80/circuitpride_128"
        arrayMSG[2] = "4U 70s"
        arrayRadios[2] = "http://listen.radionomy.com/4U-70s"
        arrayMSG[3] = "RAP Regulator"
        arrayRadios[3] = "http://149.56.175.167:5632/stream"
        arrayMSG[4] = "Solo Guitar"
        arrayRadios[4] = "http://23.82.11.88:2628/stream"          
      Case 16
        'MIX 03
        arrayMSG[0] = "Native Calm"
        arrayRadios[0] = "http://23.82.11.89:3428/stream"
        arrayMSG[1] = "Cocktail Jazz"
        arrayRadios[1] = "http://23.82.11.87:21228/stream"
        arrayMSG[2] = "Hits Spain"
        arrayRadios[2] = "http://91.121.155.204:8022/stream"
        arrayMSG[3] = "X Rocks"
        arrayRadios[3] = "http://142.4.217.133:8758/stream"
        arrayMSG[4] = "Terra Zen"
        arrayRadios[4] = "http://87.98.130.255:8416/stream"          
      Case 17  
        ' MIX 04
        arrayMSG[0] = "Radio Musical"
        arrayRadios[0] = "http://s1.voscast.com:7274/"
        arrayMSG[1] = "Reggae Trade"
        arrayRadios[1] = "http://185.33.21.112:80/reggae_32a"
        arrayMSG[2] = "Altern Rock"
        arrayRadios[2] = "http://144.217.180.30:8123/stream"
        arrayMSG[3] = "A. I."
        arrayRadios[3] = "http://51.68.199.215:8010/radio.mp3"
        arrayMSG[4] = "Dark Edge"
        arrayRadios[4] = "http://5.35.214.196:8000/"  
        Case Else
        ' Radio Linux - Años 30 y 40
        arrayMSG[0] = "Big Band Era"
        arrayRadios[0] = "http://listen.radionomy.com:80/TheBigBandEra"
        arrayMSG[1] = "Mega1050 40s"
        arrayRadios[1] = "http://94.23.23.97:7244/"
        arrayMSG[2] = "Shawn Nagy's"
        arrayRadios[2] = "http://uk1-pn.webcast-server.net:8384/"
        arrayMSG[3] = "KWPO Radio"
        arrayRadios[3] = "http://listen.shoutcast.com/kwporadioonline"
        arrayMSG[4] = "Kandy Radio"
        arrayRadios[4] = "http://s2.radio.co/s60ca9ca66/listen"
        BloqueEmisoras = 0                
    End Select
  ' Al cambiar siempre situamos en primera (0) emisora
  idEmisora = 0
  labelEMISORA.text = "... " & idEmisora & " ..."
  labelTipoEmisora.Text = ArrayTipoMusica[BloqueEmisoras]  
End

